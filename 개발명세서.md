# 📘 개발 명세서

**프로젝트명:** SonarQube Python 위반분석 AI Agent  
**작성일:** 2025.06.11  
**작성자:** @aidx.edu15  
**개발환경:** Python + Azure OpenAI + Streamlit + Azure Web App

---

## 1. 프로젝트 개요

### 1.1 목적
SonarQube의 Python 정적 분석 결과에서 검출된 위반 사항을 바탕으로, 입력된 코드와 위반된 룰을 분석하여 정탐/오탐 여부를 판단하고, 정탐일 경우 해당 룰을 준수하는 개선 코드를 AI가 제안해주는 Agent를 개발한다.

### 1.2 목표
- SonarQube Python 룰 전체를 대상으로 AI 판단 및 코드 수정 기능 제공
- Azure OpenAI를 활용하여 룰 해석 및 코드 리팩토링 자동화
- Streamlit 기반 UI를 통해 사용자 입력 및 결과 확인 기능 제공
- Azure Web App 상에 배포 가능하도록 구성

---

## 2. 주요 기능 정의

| 기능명         | 설명                                                         |
| -------------- | ------------------------------------------------------------ |
| 소스코드 입력  | 사용자가 Python 코드 및 SonarQube 룰 ID 입력                |
| 룰 처리        | 해당 룰의 정의/설명을 DB 또는 API로부터 조회                |
| 정탐/오탐 판별 | Azure OpenAI를 통해 위반의 유효성 여부 판단                |
| 코드 수정 제안 | 룰 준수 코드 예시를 AI가 자동 생성                         |
| 결과 출력      | 정탐/오탐, 사유, 수정 코드 제시                             |
| UI 구성        | Streamlit 기반 입력/출력 인터페이스                         |
| 웹 배포        | Azure Web App 상에 실행되도록 구조 구성                     |

---

## 3. 기술 스택

| 항목      | 기술                                 |
| --------- | ------------------------------------ |
| 언어      | Python 3.10+                         |
| AI        | Azure OpenAI (GPT-4 기반)            |
| 프레임워크| Streamlit                            |
| 백엔드    | FastAPI (모듈 분리 시, 선택)          |
| 배포      | Azure Web App (Linux / Python)        |
| 룰 소스   | SonarSource 공식 문서 및 API          |

---

## 4. UI 설계

### 4.1 구성

| 화면 요소      | 설명                                         |
| -------------- | -------------------------------------------- |
| 코드 입력 영역 | Python 코드 입력 TextArea                    |
| 룰 입력 영역   | 위반 룰 ID (예: python:S3776) 입력           |
| 분석 실행 버튼 | Analyze 버튼으로 분석 시작                   |
| 결과 출력      | 정탐/오탐 여부, 판단 근거 요약, 수정 코드 예시 (Syntax Highlight) |
| 로그/다운로드  | 결과 다운로드 기능 (csv or md, 선택)         |

---

## 5. 시스템 구조도 (간략)
css
복사
편집
[사용자]
   ↓ Streamlit UI
[분석 요청]
   ↓
[Python 모듈]
   ↓
[Azure OpenAI API]
   ↓
[분석 결과 반환]
   ↓
[결과 시각화 및 출력]
---

## 6. 개발 일정 (예상)
| 단계   | 내용                                     | 기간   |
| ------ | ---------------------------------------- | ------ |
| 1단계  | 요구사항 확정 및 유즈케이스 정리        | 1일    |
| 2단계  | 룰 DB 구성 (룰 파싱 및 구조화)          | 2일    |
| 3단계  | 정탐/오탐 판단 로직 및 프롬프트 개발   | 2일    |
| 4단계  | 수정 코드 생성 프롬프트 튜닝           | 2일    |
| 5단계  | Streamlit UI 개발                       | 2~3일  |
| 6단계  | 통합 및 Azure Web App 배포              | 2일    |
| 7단계  | 테스트, 사용자 문서화, 예외처리 정비   | 2~3일  |

---

## 7. 향후 확장 방향
- SonarQube 리포트(JSON/XML) 자동 파싱 기능 추가
- 정탐/오탐 학습 기반 피드백 반영 구조 도입
- 다중 코드 및 일괄 분석 기능
- 룰 중요도(severity)에 따른 필터링 및 가중치 조정

---

## 8. 추가 참고 정보
- 룰 DB는 SonarSource 공식 Python 룰 페이지를 참조해 정리
- 오탐 판단은 AI에게 위임하되, 사용자가 검수할 수 있는 구조 유지
- 수정 코드는 AI가 자동 제안하고 사람이 리뷰/확정